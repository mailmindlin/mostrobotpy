---
extra_includes:
  - rpy/geometryToString.h
  - wpystruct.h

functions:
  to_json:
    ignore: true
  from_json:
    ignore: true
classes:
  Quaternion:
    shared_ptr: false
    methods:
      Quaternion:
        overloads:
          "":
          double, double, double, double:
      operator+:
      operator-:
      operator*:
        overloads:
          const double [const]:
          const Quaternion& [const]:
      operator/:
      operator==:
      operator!=:
      Dot:
      Conjugate:
      Inverse:
      Normalize:
      Norm:
      Pow:
      Exp:
        overloads:
          const Quaternion& [const]:
          '[const]':
      Log:
        overloads:
          const Quaternion& [const]:
          '[const]':
      W:
      X:
      Y:
      Z:
      ToRotationVector:
      FromRotationVector:

inline_code: |
  cls_Quaternion
    .def("__repr__", py::overload_cast<const Quaternion&>(&rpy::toString))
    .def(py::pickle(
        [](const Quaternion &self) { // __getstate__
            return py::make_tuple(self.W(), self.X(), self.Y(), self.Z());
        },
        [](py::tuple t) { // __setstate__
            if (t.size() != 4)
                throw std::runtime_error("Invalid state!");
            
            return Quaternion(
              t[0].cast<double>(),
              t[1].cast<double>(),
              t[2].cast<double>(),
              t[3].cast<double>()
            );
        }
    ))
  ;

  SetupWPyStruct<frc::Quaternion>(cls_Quaternion);
